# 中控与无人机节点间话题交互说明

关键代码文件：midControl.py 一个可视化的窗口，能够订阅无人车/无人机的状态信息

同时可向无人车/无人机发送命令

## 通信配置

### 网络连接配置

中控节点

export ROS_MASTER_URI=http://localhost:11311

export ROS_IP=192.168.1.123

无人机节点 

export ROS_MASTER_URI=http://localhost:11311

export ROS_IP=192.168.1.11

rosbridge配置

rosbridge运行在无人机端，端口9090

## 话题交互设计

1. 指令下发通道

话题名称: /drone_command

消息类型: std_msgs/String

方向: 中控 → 无人机

功能: 中控发送控制指令给无人机

实现代码:

python

`# 中控端 - 指令发布`

`self.command_topic = roslibpy.Topic(self.client, '/drone_command', 'std_msgs/String')`

`command_message = roslibpy.Message({'data': command})`

`self.command_topic.publish(command_message)`

`# 无人机端 - 指令订阅`

`rospy.Subscriber('/drone_command', String, command_callback)`

2. 状态反馈通道

话题名称: /uav_status_update

消息类型: std_msgs/String

方向: 无人机 → 中控

功能: 无人机向中控反馈任务执行状态

实现代码:

python

`# 无人机端 - 状态发布`

status_pub = rospy.Publisher('/uav_status_update', String, queue_size=10)

status_pub.publish("UAV takeoff successfully")

`# 中控端 - 状态订阅`

status_topic = roslibpy.Topic(self.client, '/uav_status_update', 'std_msgs/String')

status_topic.subscribe(status_callback)